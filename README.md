# PR Reviewer Assignment Service

---

## Стек технологий

* **Язык:** Go 1.25
* **База данных:** PostgreSQL 15
* **ORM:** GORM 
* **Инфраструктура:** Docker, Docker Compose
* **Тестирование:**
    * Unit: `testify`
    * Integration: `testcontainers-go`
    * Load: `k6`

---

## Что сделано

* Выполнены все основные требования
* Добавлен эндпоинт со статистикой
* Проведено нагрузочное тестирование
* Добавлен метод массовой деактивации пользователей
* Реализовано интеграционное тестирование
* Добавлена конфигурация линтера

---

## Запуск проекта

Для запуска необходим **Docker** и **.env** файл. Поля **.env** файла должны быть такими же как и в **.env.example**

### Быстрый старт

Приложение и база данных поднимаются одной командой:

```bash
make run
```

Сервис будет доступен по адресу: `http://localhost:8080`

### Остановка

```bash
make stop
```

---

### 1. Unit-тесты

```bash
make test
```

### 2. Интеграционные тесты

```bash
make test-integration
```

### 3. Нагрузочное тестирование (k6)

**Сценарий:** Разгон до 20 одновременных пользователей, на эндпоинт: создание PR.

**Результаты:**

| Метрика         | Требование ТЗ | Результат  | Статус |
|:----------------|:-------------:|:----------:|:------:|
| **RPS**         |       5       |  **~31**   |   OK   |
| **Latency p95** |   < 300 ms    | **~58 ms** |   OK   |
| **Error Rate**  |    < 0.1%     | **0.00%**  |   OK   |

---

## API Endpoints

**Teams**

* `POST /team/add` — Создать команду и участников.
* `GET /team/get` — Получить состав команды.

**Users**

* `POST /users/setIsActive` — Сменить статус активности.
* `GET /users/getReview` — Список назначенных ревью.
* `POST /users/massDeactivate` — Массовая деактивация + переназначение.
* `GET /analytics/pr` — Статистика по ревьюверам.

**Pull Requests**

* `POST /pullRequest/create` — Создать PR.
* `POST /pullRequest/reassign` — Сменить ревьювера.
* `POST /pullRequest/merge` — Завершить PR.
